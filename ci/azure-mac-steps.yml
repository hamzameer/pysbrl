steps:

- script: |
    brew install gsl gmp
  displayName: 'Brew install dependencies'

- script: |
    python -m pip wheel . -w wheelhouse/
  displayName: 'Build'
  
- script: |
    ls -lh wheelhouse
    mkdir -p dist
    cp wheelhouse/mdlp_discretization* dist/.
  displayName: 'Show wheelhouse'

- script: |
    python -m pip install $(package_name) --no-index -f wheelhouse
  displayName: 'Install wheel'

- script: |
    python -m pip install delocate
    /Library/Frameworks/Python.framework/Versions/$(python.version)/bin/delocate-wheel dist/$(package_name)*.whl
  displayName: 'Delocate wheels'

- script: |
    pip install pytest pytest-azurepipelines
    pytest
  displayName: 'pytest'
